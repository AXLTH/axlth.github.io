<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>FixMyHome ‚Äî Connection Test</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<style>
  :root{--bg:#0b1020;--card:#121833;--text:#e9ecf1;--muted:#b8bfd1;--accent:#7aa2ff;--ring:rgba(122,162,255,.5)}
  *{box-sizing:border-box} body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text)}
  .container{width:min(1000px,92vw);margin:0 auto;padding:28px 0}
  .card{background:var(--card);border:1px solid rgba(255,255,255,.1);border-radius:14px;padding:1rem}
  h1{margin:.2rem 0 1rem} .muted{color:var(--muted)}
  input,button{padding:.8rem 1rem;border-radius:12px;border:1px solid rgba(255,255,255,.15);background:rgba(255,255,255,.03);color:var(--text)}
  button{cursor:pointer;background:var(--accent);border:0;color:#0b1020;font-weight:700}
  pre{white-space:pre-wrap;word-wrap:break-word;background:#0f1530;border-radius:10px;padding:12px;border:1px solid rgba(255,255,255,.08);max-height:320px;overflow:auto}
  .row{display:flex;gap:.6rem;align-items:center;flex-wrap:wrap}
  .pill{display:inline-block;padding:.35rem .6rem;border:1px solid rgba(255,255,255,.15);border-radius:999px}
</style>
</head>
<body>
<div class="container">
  <h1>FixMyHome ‚Äî Supabase Connection</h1>
  <p class="muted">This page only verifies that your website can talk to your Supabase database. You‚Äôll see the result below.</p>

  <div class="card" style="margin-top:1rem">
    <div class="row" style="justify-content:space-between">
      <strong>Status:</strong>
      <span id="status" class="pill">Not tested</span>
    </div>

    <div style="margin:.8rem 0">
      <button id="testBtn">Test Supabase Connection</button>
    </div>

    <p class="muted">Result log:</p>
    <pre id="log"></pre>

    <p class="muted" style="margin-top:.6rem">
      Reminder: in Supabase ‚Üí <em>Authentication ‚Üí URL Configuration</em>, set
      <code>Site URL</code> and a <code>Redirect URL</code> to <code>https://axlth.github.io</code>.
    </p>
  </div>
</div>

<!-- Supabase JS -->
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script>
  // üîê Replace these with your real values from Settings ‚Üí API
  const SUPABASE_URL = "https://yeexofhlqmjgxvgoibfb.supabase.co"; // e.g., https://abcd1234.supabase.co
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InllZXhvZmhscW1qZ3h2Z29pYmZiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU0NjgzNTEsImV4cCI6MjA3MTA0NDM1MX0.48YGypaZ-uN7ved_X2LdzkajfT7ePUG61kM6Hz7s68U";

  // Create client
  const sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  const $ = (id)=>document.getElementById(id);
  const logEl = $("log");
  const statusEl = $("status");
  const testBtn = $("testBtn");

  function log(msg){
    const time = new Date().toLocaleTimeString();
    logEl.textContent += `[${time}] ${msg}\n`;
    logEl.scrollTop = logEl.scrollHeight;
  }

  async function testConnection(){
    statusEl.textContent = "Testing‚Ä¶";
    statusEl.style.borderColor = "rgba(255,255,255,.35)";
    log("Querying table: skills");

    try {
      const { data, error } = await sb.from("skills").select("*").order("name");
      if (error) throw error;
      log(`‚úÖ Connected. Received ${data.length} rows from 'skills'.`);
      if (data.length) {
        log("Sample rows: " + data.slice(0, 5).map(r => r.name).join(", "));
      }
      statusEl.textContent = "Connected";
      statusEl.style.borderColor = "#7bffa1";
    } catch (err) {
      log("‚ùå Error: " + (err?.message || String(err)));
      statusEl.textContent = "Failed";
      statusEl.style.borderColor = "#ffa1a1";
    }
  }

  testBtn.addEventListener("click", testConnection);

  // Auto-test on load
  window.addEventListener("load", testConnection);
</script>
</body>
</html>
